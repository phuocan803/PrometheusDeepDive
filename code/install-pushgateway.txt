
#Create a user and group for Pushgateway:
sudo useradd -M -r -s /bin/false pushgateway

#Download and install the Pushgateway binary:
wget https://github.com/prometheus/pushgateway/releases/download/v1.11.0/pushgateway-1.11.0.linux-amd64.tar.gz
tar xvfz pushgateway-1.11.0.linux-amd64.tar.gz
sudo cp pushgateway-1.11.0.linux-amd64/pushgateway /usr/local/bin/
sudo chown pushgateway:pushgateway /usr/local/bin/pushgateway

#Create a systemd unit file for Pushgateway:
sudo nano /etc/systemd/system/pushgateway.service

[Unit]
Description=Prometheus Pushgateway
Wants=network-online.target
After=network-online.target
[Service]
User=pushgateway
Group=pushgateway
Type=simple
ExecStart=/usr/local/bin/pushgateway
[Install]
WantedBy=multi-user.target

#Start and enable the pushgateway service:
sudo systemctl enable pushgateway
sudo systemctl start pushgateway

#Verify the service is running and it is serving metrics
sudo systemctl status pushgateway
curl localhost:9091/metrics


#Configure Prometheus to Scrape Metrics from Pushgateway
#Edit the Prometheus config:
sudo nano /etc/prometheus/prometheus.yml

- job_name: 'Pushgateway'
    honor_labels: true
    static_configs:
    - targets: ['localhost:9091']

#Restart Prometheus to load the new configuration:
sudo systemctl restart prometheus

#Access the expression browser in a web browser at http://<PROMETHEUS_SERVER_PUBLIC_IP>:9090.
#Run a query to view some Pushgateway metric data
pushgateway_build_info
